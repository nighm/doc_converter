# 文档转换工具开发计划

## 项目概述
本项目开发一个文档转换工具，支持多种格式转换。采用增量开发模式，确保每个步骤都是可工作的。

## 开发阶段

### 第一阶段：基础框架搭建 [已完成]

1. 核心框架 [已完成]
   - [x] 创建最小的CMake配置 (2024-03-26)
   - [x] 创建基础文档接口（Document）(2024-03-26)
   - [x] 创建基础转换器接口（Converter）(2024-03-26)
   - [x] 编写简单的测试程序验证接口 (2024-03-26)

2. 单元测试框架 [已完成]
   - [x] 添加Google Test支持 (2024-03-26)
   - [x] 创建基本的测试用例 (2024-03-26)
   - [x] 确保测试可以运行 (2024-03-26)

3. 持续集成 [已完成]
   - [x] 配置GitHub Actions (2024-03-26)
   - [x] 确保CI可以正常运行 (2024-03-26)

### 第二阶段：基础功能实现 [进行中]

1. 文档解析基础 [已完成]
   - [x] 实现基本的文档类 (include/doc_converter/basic_document.hpp - 2024-03-26)
   - [x] 实现文档元素类 (include/doc_converter/document_elements.hpp - 2024-03-26)
   - [x] 编写对应的单元测试 (tests/document_elements_test.cpp, tests/basic_document_test.cpp - 2024-03-26)
   - [x] 实现基本的转换器 (include/doc_converter/basic_converter.hpp - 2024-03-26)
   - [x] 编写转换器的单元测试 (tests/basic_converter_test.cpp - 2024-03-26)

2. 转换器框架 [进行中]
   - [x] 实现转换器工厂 (2024-03-26)
   - [x] 编写转换器测试 (2024-03-26)
   - [x] 实现基本的Word文档解析器 (2024-03-26)
     - [x] 支持.docx格式解析 (2024-03-26)
     - [x] 支持.doc格式解析 (2024-03-31)
     - [x] 添加错误处理和日志 (2024-03-31)
     - [x] 优化CMake构建配置 (2024-04-01)
     - [ ] 支持表格元素
     - [ ] 支持图片元素
   - [ ] 实现基本的PPT生成器

### 第三阶段：GUI框架（5天）
1. Qt基础配置
   - [ ] 添加Qt依赖
   - [ ] 配置Qt MOC
   - [ ] 验证Qt构建系统

2. 主窗口开发
   - [ ] 创建基本窗口
   - [ ] 添加基础控件
   - [ ] 实现简单交互

### 第四阶段：Word转换功能（7天）
1. Word解析
   - [ ] 添加Word解析库
   - [ ] 实现Word文档读取
   - [ ] 实现文档结构解析

2. HTML生成
   - [ ] 实现HTML转换器
   - [ ] 实现样式转换
   - [ ] 添加单元测试

### 第五阶段：功能完善（10天）
1. 用户界面完善
   - [ ] 实现文件选择
   - [ ] 添加进度显示
   - [ ] 添加错误提示

2. 转换功能增强
   - [ ] 添加批量转换
   - [ ] 添加转换选项
   - [ ] 优化转换性能

## 当前进度
- [x] 创建了基本目录结构 (2024-03-26)
- [x] 配置了基础的CMake构建系统 (2024-03-26)
- [x] 添加了基本的单元测试框架 (2024-03-26)
- [x] 实现了核心接口设计 (2024-03-26)
- [x] 配置了持续集成系统 (2024-03-26)
- [x] 完成了转换器工厂的实现 (2024-03-26)
- [x] 添加了详细的代码注释 (2024-03-26)
- [x] 实现了基本的文档类和文档元素类 (2024-03-26)
- [x] 完成了所有基础类的单元测试 (2024-03-26)
- [x] 实现了基本的转换器和测试 (2024-03-26)
- [x] 实现了基本的Word文档解析器（.docx格式）(2024-03-26)
- [x] 实现了日志系统 (2024-03-26)
- [x] 完成了v0.1.0版本更新 (2024-03-26)
  - 优化了代码结构，解决了重复定义问题
  - 规范化了头文件依赖关系
  - 完善了文档注释
  - 添加了日志系统
  - 所有测试用例通过
- [x] 完成了v1.1.0版本更新 (2024-03-31)
  - 改进了文件格式检查逻辑
  - 完善了错误处理和日志记录
  - 优化了测试用例实现
  - 所有测试用例通过
- [x] 完成了v1.1.1版本更新 (2024-04-01)
  - 优化了CMake构建配置
  - 修复了包含路径问题
  - 所有测试用例通过
- [ ] 完善Word文档解析器（表格、图片等）(进行中)
- [ ] 其他任务尚未开始
- [x] 完成了项目基础架构的搭建 (2024-03-26)
  - 创建了完整的目录结构
  - 实现了所有基础接口
  - 配置了构建系统
  - 添加了测试框架
  - 实现了日志系统
- [x] 完成了基础测试框架的搭建 (2024-03-26)
  - 实现了所有核心类的单元测试
  - 添加了文档元素测试
  - 添加了转换器测试
  - 添加了Word文档测试
  - 所有测试用例通过

## 开发原则
1. 增量开发：每个步骤都确保可以正常构建和运行
2. 测试驱动：先写测试，再实现功能
3. 持续集成：每个功能完成后都要运行完整测试
4. 代码可读性：所有新代码必须包含详细的注释
   - 文件头必须包含完整的文件说明
   - 每个类必须说明其用途和职责
   - 每个方法必须说明其功能、参数和返回值
   - 复杂逻辑必须有详细的实现说明
   - 代码修改时必须同步更新相关注释

## 下一步工作
1. ~~创建最小化的CMake配置~~ (2024-03-26)
2. ~~实现基础的文档接口~~ (2024-03-26)
3. ~~添加基本的单元测试~~ (2024-03-26)
4. ~~优化CMake构建配置~~ (2024-04-01)
5. 完善Word文档解析器
   - ~~添加.doc格式支持~~ (2024-03-31)
   - ~~添加错误处理和日志记录~~ (2024-03-31)
   - 添加表格元素支持
   - 添加图片元素支持
6. 开始GUI框架开发
   - 添加Qt依赖
   - 配置Qt MOC
   - 创建基本窗口界面

## 注意事项
1. 每个阶段开始前确保前一阶段完全可用
2. 避免过早引入复杂依赖
3. 保持代码简单，逐步添加功能

## 测试规范

### 单元测试
1. 每个功能模块必须有对应的单元测试
2. 测试覆盖率要求达到80%以上
3. 测试用例要包含正常和异常情况

### 集成测试
1. 每个阶段完成后进行集成测试
2. 测试不同模块之间的交互
3. 验证整体功能的正确性

### 用户测试
1. 每个功能完成后进行实际文档测试
2. 收集用户反馈并及时调整
3. 验证用户体验

## 问题跟踪
1. 待解决的问题
   - [x] 需要确定Word解析库的选择 (2024-03-26)
     - 选择Microsoft Office Open XML SDK作为Word解析库
     - 原因：开源、专注.docx格式、文档完善、无额外依赖
   - [ ] 需要设计文档解析的数据结构
   - [ ] 需要规划并发处理方案

2. 已解决的问题
   - [x] 完成了基本项目结构设计 (2024-03-26)
   - [x] 实现了基础文档接口 (2024-03-26)
   - [x] 完成了基本转换器实现 (2024-03-26)
   - [x] 解决了重复定义问题 (2024-03-26)
     - 创建了 common.hpp 统一管理共享定义
     - 规范化了头文件包含关系
     - 避免了循环依赖

## 风险管理
1. 技术风险
   - Word文档格式复杂，可能影响解析准确性
   - 大文件处理可能存在性能问题

2. 解决方案
   - 选择成熟的文档处理库
   - 实现分块处理机制
   - 添加详细的错误处理

## 代码规范

### 文件组织
1. 头文件（*.hpp）
   - 放置在 include/doc_converter 目录下
   - 只包含类和接口的声明
   - 使用 pragma once 防止重复包含
   - 依赖关系：
     - common.hpp：基础共享定义，不依赖其他头文件
     - document.hpp：依赖 common.hpp
     - document_elements.hpp：依赖 common.hpp
     - word_document.hpp：依赖 common.hpp 和 document.hpp
     - basic_document.hpp：依赖 common.hpp 和 document.hpp
     - basic_converter.hpp：依赖 common.hpp 和 document.hpp
     - logger.hpp：独立模块，不依赖其他头文件

2. 源文件（*.cpp）
   - 放置在 src 目录下
   - 实现对应头文件中声明的功能
   - 遵循目录结构组织代码

3. 测试文件（*_test.cpp）
   - 放置在 tests 目录下
   - 文件名与被测试的模块对应
   - 包含完整的测试用例

### 注释规范
1. 强制性要求
   - 所有新添加的代码必须包含完整注释
   - 注释必须与代码保持同步
   - 注释应该解释"为什么"而不仅仅是"是什么"
   - 复杂算法必须包含实现原理的说明
   - 代码修改时必须检查并更新相关注释

2. 文件头注释
   ```cpp
   /**
    * @file filename.hpp
    * @brief 文件的简要说明
    * @author 作者信息
    * @date 创建日期
    * 
    * 详细说明文件的主要内容，包括：
    * - 包含的主要组件
    * - 重要的依赖关系
    * - 使用注意事项
    * - 修改历史记录
    */
   ```

3. 类注释
   ```cpp
   /**
    * @brief 类的简要说明
    * @details 详细的类说明
    * 
    * 详细说明类的功能和用途，包括：
    * - 主要功能和职责
    * - 使用方法和示例
    * - 注意事项和限制
    * - 与其他类的关系
    * - 线程安全性说明
    */
   ```

4. 函数注释
   ```cpp
   /**
    * @brief 函数的简要说明
    * @details 详细的函数说明
    * @param paramName 参数的详细说明，包括取值范围和单位
    * @return 返回值的详细说明
    * @throws 可能抛出的异常说明
    * @note 特殊说明和注意事项
    * @see 相关函数或类的引用
    */
   ```

5. 重要代码段注释
   - 对复杂算法添加实现原理说明
   - 对重要的业务逻辑添加详细说明
   - 对特殊情况的处理添加说明
   - 对性能相关的代码添加说明
   - 对临时解决方案添加TODO说明

### 调试信息
1. 日志级别
   - ERROR：错误信息，影响程序正常运行
   - WARN：警告信息，可能影响程序行为
   - INFO：重要流程信息
   - DEBUG：调试相关信息
   - TRACE：详细跟踪信息

2. 日志内容
   - 函数入口和出口
   - 重要参数值
   - 执行时间
   - 错误原因

